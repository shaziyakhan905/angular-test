<div class="container py-4" *ngIf="testData">
  <h2 class="mb-4 text-primary">{{ testData.title }}</h2>

  <!-- Show each question -->
  <form (ngSubmit)="submitTest()" *ngIf="resultStatus === ''">
    <div *ngFor="let question of questions; let i = index" class="mb-4 p-3 border rounded shadow-sm bg-white">
      <h5 class="mb-3">Q{{ i + 1 }}. {{ question.questionText }}</h5>

      <!-- RADIO -->
      <ng-container *ngIf="question.type === 'radio'">
        <div *ngFor="let option of question.options" class="form-check mb-2">
          <input class="form-check-input"
                 type="radio"
                 [name]="'q' + i"
                 [value]="option"
                 [checked]="selectedAnswers[i] === option"
                 (change)="selectAnswer(i, option)">
          <label class="form-check-label">{{ option }}</label>
        </div>
      </ng-container>

      <!-- CHECKBOX -->
      <ng-container *ngIf="question.type === 'checkbox'">
        <div *ngFor="let option of question.options" class="form-check mb-2">
          <input class="form-check-input"
                 type="checkbox"
                 [value]="option"
                 [checked]="selectedAnswers[i]?.includes(option)"
                 (change)="toggleCheckbox(i, option)">
          <label class="form-check-label">{{ option }}</label>
        </div>
      </ng-container>

      <!-- TEXTAREA -->
      <ng-container *ngIf="question.type === 'textarea'">
        <textarea class="form-control"
                  rows="4"
                  [(ngModel)]="selectedAnswers[i]"
                  [name]="'q' + i"
                  placeholder="Type your answer here..."></textarea>
      </ng-container>
    </div>

    <button class="btn btn-success w-100 mt-3" type="submit" [disabled]="isSubmitDisabled()">Submit Test</button>
  </form>

  <!-- Result Message UI will be handled in separate TestResultComponent -->
</div>
